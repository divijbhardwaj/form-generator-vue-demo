(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{341:function(e,o,t){"use strict";t.r(o);var r={props:{value:{type:Object,default:null,required:!1},onSubmit:{type:Function,required:!1,default:()=>{console.error("submit handler not present")}},components:{type:Array,required:!1,default:()=>[]},disabled:{type:Boolean,required:!1,default:!1},schema:{type:Object,default:()=>({})},classes:{type:Object,required:!1,default:()=>({})},onSubmitFail:{type:Function,required:!1,default:()=>{console.warn("Form submit fail")}},activeValidation:{type:Boolean,required:!1,default:!1},activeValidationDelay:{type:Number,required:!1,default:0},logs:{type:Boolean,required:!1,default:!1}}};let n;const l={isUndef:e=>void 0===e,isObjNotArr:e=>l.isArr(e)?e.every(e=>l.isObj(e)&&!l.isArr(e)):l.isObj(e)&&!l.isArr(e),isObj:e=>l.isArr(e)?e.every(e=>"object"==typeof e):"object"==typeof e,isArr:e=>Array.isArray(e),isFunc:e=>"function"==typeof e,isBool:e=>"boolean"==typeof e,isStr:e=>"string"==typeof e,throwError(e){throw new Error(e)},warn(e){console.warn(e)},hasProperty:(e,o)=>l.isArr(e)?e.every(e=>e in o):e in o,handleFunc(e,o){if(l.isFunc(e))return e(o)},handleFuncOrBool(e,o){let t=Boolean(e);return l.isFunc(e)&&(t=e(o)),t},debounce:e=>function(time){return function(p){clearTimeout(n),n=setTimeout((function(){clearTimeout(n),e(p)}),time)}}},d={form:"fgv-form",header:"fgv-form__header",body:"fgv-form__body",footer:"fgv-form__footer",row:"fgv-form__body__row",col:"fgv-form__body__row__col"},c={header:"header",footer:"footer",beforeComponent:e=>"before-"+e,afterComponent:e=>"after-"+e,beforeRow:"before-row",afterRow:"after-row",beforeCol:"before-col",afterCol:"after-col"},f="fields",h="values",m="errors",v="activeValidation",_="activeValidationDelay",S="v-on",y="component",w="hide",C={text:"text",number:"number"},O={required:"required",disabled:"disabled"};function F(template,style,script,e,o,t,r,n,l,d){"boolean"!=typeof r&&(l=n,n=r,r=!1);const c="function"==typeof script?script.options:script;let f;if(template&&template.render&&(c.render=template.render,c.staticRenderFns=template.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),e&&(c._scopeId=e),t?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),style&&style.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(t)},c._ssrRegister=f):style&&(f=r?function(e){style.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){style.call(this,n(e))}),f)if(c.functional){const e=c.render;c.render=function(o,t){return f.call(t),e(o,t)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,f):[f]}return script}const A=F({render:function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("form",{class:[e.CLASS.form],on:{submit:function(o){return o.preventDefault(),e.handleSubmit(o)}}},[t("div",{class:[e.CLASS.header]},[e._t(e.SLOT.header)],2),e._v(" "),t("div",{class:[e.CLASS.body]},[e._l(e.fieldsSchema,(function(o,i){return[e.showRow(o)?e._t(e.SLOT.beforeRow,null,{model:e.slotProps(o)}):e._e(),e._v(" "),e.showRow(o)?t("div",{key:i,class:[e.CLASS.row,e.classes.row]},[e.UTILS.isArr(o)?[e._l(o,(function(s){return[e.showCol(s)?e._t(e.SLOT.beforeCol,null,{model:e.slotProps(s)}):e._e(),e._v(" "),e.showCol(s)?t("div",{key:s.model,class:[e.CLASS.col,s.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(s.model)),e._v(" "),t(e.componentToRender(s),e._g(e._b({tag:"component",model:{value:e.fields[s.model],callback:function(o){e.$set(e.fields,s.model,o)},expression:"fields[s.model]"}},"component",e.componentProps(s),!1),e.componentEvents(s)),[e._t(s.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(s.model))],2):e._e(),e._v(" "),e.showCol(s)?e._t(e.SLOT.afterCol,null,{model:e.slotProps(s)}):e._e()]}))]:[e.showCol(o)?e._t(e.SLOT.beforeCol,null,{model:e.slotProps(o)}):e._e(),e._v(" "),e.showCol(o)?t("div",{key:o.model,class:[e.CLASS.col,o.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(o.model)),e._v(" "),t(e.componentToRender(o),e._g(e._b({tag:"component",model:{value:e.fields[o.model],callback:function(t){e.$set(e.fields,o.model,t)},expression:"fields[schema.model]"}},"component",e.componentProps(o),!1),e.componentEvents(o)),[e._t(o.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(o.model))],2):e._e(),e._v(" "),e.showCol(o)?e._t(e.SLOT.afterCol,null,{model:e.slotProps(o)}):e._e()]],2):e._e(),e._v(" "),e.showRow(o)?e._t(e.SLOT.afterRow,null,{model:e.slotProps(o)}):e._e()]}))],2),e._v(" "),t("div",{class:e.CLASS.footer},[e._t(e.SLOT.footer)],2)])},staticRenderFns:[]},void 0,{mixins:[r],data(){let e={},o={};const t=t=>{e[t]=this.vModelValid(!0)&&h in this.value&&this.value[h][t]||"",o[t]=this.vModelValid(!0)&&m in this.value&&this.value[m][t]||""};if(f in this.schema&&l.isArr(this.schema.fields)&&this.schema.fields.length)for(const e of this.schema.fields)if(l.isArr(e))for(const s of e)t(s.model);else t(e.model);return{fields:e,errors:o,submit:!1}},computed:{SLOT:()=>c,CLASS:()=>d,UTILS:()=>l,avGlobal(){return this.activeValidation||!1},avDelayGlobal(){return this.activeValidationDelay||0},fieldsSchema(){return f in this.schema&&l.isArr(this.schema[f])?this.schema[f]:[]},fieldsSchemaFlat(){let e=[];for(const o of this.fieldsSchema)if(l.isArr(o))for(const s of o)e.push(s);else e.push(o);return e},fieldsSchemaMap(){const map=this.fieldsSchemaFlat.map(s=>[s.model,s]);return Object.fromEntries(map)},deValidateField(){return l.debounce(e=>{this.validateField(e)})}},watch:{disabled:{handler:function(e){e&&this.removeAllErrors()}},value:{handler:function(){if(this.vModelValid())for(const e in this.value[h])this.fields[e]=this.value[h][e],this.errors[e]=this.value[m][e]},deep:!0},fields:{handler:function(){this.rmUnwantedModels(),this.$emit("input",{values:this.fields,errors:this.errors})},deep:!0,immediate:!0}},created(){for(const e in this.fields){const o=this.findSchema(e);this.$watch("fields."+e,(function(e,t){this.typeCoercion(o),e==t&&typeof e!=typeof t||this.validate(o,!0)}),{deep:!0})}},methods:{slotProps:e=>l.isArr()?e.map(({model:e})=>e):e.model,validate(e,o=!1){if(e&&o){const o=Boolean(e[v])||this.avGlobal,t=e&&e[_]||this.avDelayGlobal;return void(o&&t?this.deValidateField(t)(e):this.validateField(e))}const t={};Object.values(this.fieldsSchemaMap).forEach(s=>{const e=this.validateField(s);t[s.model]=!e||!this.fieldRequired(s)});const r=Object.keys(t).find(e=>!t[e]);return[t,r]},showRow(e){return this.hasFieldsToRender(e)||this.showCol(e)},hasFieldsToRender(e){return l.isArr(e)&&e.length&&e.some(s=>!this.fieldHidden(s))},showCol(e){return this.componentToRender(e)&&!this.fieldHidden(e)},vModelValid(e=!1){const o=this.value&&l.isObjNotArr(this.value),t=h in this.value&&l.isObjNotArr(this.value[h]),r=m in this.value&&l.isObjNotArr(this.value[m]);return e?o&&t:o&&t&&r},resetFormState(){this.submit=!1},removeAllErrors(){for(const e in this.errors)this.errors[e]=""},setError(e,o){const t=this.errors[e];t===o||l.isObj(o,t)&&JSON.stringify(o)===JSON.stringify(t)||(this.errors[e]=o)},findComponentData(e){return this.components.find(o=>o&&o.name===e)},componentProps(e){const o=this.componentToRender(e),component=this.findComponentData(o),t=e&&e.errorProp||component&&component.errorProp||"errorMessages";return{...e.props,[t]:this.errors[e.model],ref:e.model,type:e.type||C.text,disabled:this.fieldDisabled(e),required:this.fieldRequired(e)}},typeCoercion(e){isNaN(this.fields[e.model])&&e&&e.type===C.number&&this.fields[e.model]&&(this.fields[e.model]=Number(this.fields[e.model]))},componentEvents:e=>S in e&&l.isObj(e[S])?e[S]:{},componentToRender(e){const o=e.type||C.text;if(y in e&&e[y]&&l.isStr(e[y]))return e.component;const component=this.components.find(({type:e})=>e.includes(o)),t=component&&component.name;return!t&&console.error(`Component cannot be rendered. Component for type "${o}" is not found in form-components.`),t},findSchema(e){return this.fieldsSchemaMap[e]},fieldDisabled(e){const o=!!(e&&e.props&&O.disabled in e.props)&&l.handleFuncOrBool(e.props[O.disabled]);return!(!this.disabled&&!o)},fieldRequired(e){const o=e&&e.props&&O.required in e.props?l.handleFuncOrBool(e.props[O.required]):"validator"in e;return!(!e||this.fieldDisabled(e)||this.fieldHidden(e))&&o},rmUnwantedModels(){Object.keys(this.fields).filter(e=>!this.fieldsSchemaFlat.find(({model:o})=>e===o)).forEach(e=>{delete this.fields[e],delete this.errors[e]})},fieldHidden:e=>w in e&&l.handleFuncOrBool(e[w]),validateField(e){const o=this.fieldRequired(e),t=e&&e.validator,r=Boolean(e[v])||this.avGlobal,n=(this.submit||r)&&l.handleFunc(t)||"",d=n?Boolean(n):"";return(o||!this.submit)&&this.setError(e.model,n),this.logs&&console.log({model:e.model,value:this.fields[e.model],type:typeof this.fields[e.model],valid:d,required:o,error:n}),d},async handleSubmit(){this.submit=!0,this.rmUnwantedModels();const[e,o]=this.validate();if(this.logs&&console.log("form validations:",e),o)return this.resetFormState(),void await this.onSubmitFail();await this.onSubmit(),this.resetFormState()}}},void 0,!1,void 0,!1,void 0,void 0,void 0),T=function(e){T.installed||(T.installed=!0,e.component("FormGeneratorVue",A))};A.install=T,o.default=A}}]);